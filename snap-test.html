<html>

<head>
    <meta charset="utf-8">
    <title>Snap!</title>

    <style>
        body {
            padding: 0;
            margin: 0;
            background: whitesmoke;
        }

        .languages {
            fill-opacity: 0.5;
            fill: black;
            stroke: white;
        }

        .languages:hover {
            fill: yellow;

        }

        h1 {
            width: 90%;
            margin: 10px auto 10px auto;
            left: 20px;
            top: 10px;
            font-size: 2em;
            font-weight: 100;
            color: #005DAA;
        }

        #total-container {
            width: 90%;
            margin: 10px auto 10px auto;
        }

        #map-container {
            float: left;
            width: 40%;
            border: 1px solid #d3d3d3;
            text-align: center;
            height: 600px;

        }

        #bubble-container {
            width: 40%;
            /* margin: 10px auto 10px auto; */
            border: 1px solid #d3d3d3;
            text-align: center;
            height: 600px;
            overflow: hidden;
        }

        svg {
            display: block;
            width: 100%;
            height: 100%
        }

        circle:hover {
            stroke: black;
            stroke-width: 14px;
            opacity: 0;
        }
    </style>
</head>

<script src="https://d3js.org/d3.v5.min.js"></script>

<body>

    <h1>woooooo</h1>
    <div id='total-container'>
        <div id="map-container"></div>
        <div id="bubble-container">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
            <!-- Created with Inkscape (http://www.inkscape.org/) -->
            <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="1329.0909mm" height="1423.4822mm"
                viewBox="0 0 1329.0909 1423.4822" version="1.1" id="svg8" inkscape:version="0.92.3 (2405546, 2018-03-11)"
                sodipodi:docname="colorBubbles.svg">
                <defs id="defs2" />
                <sodipodi:namedview id="base" pagecolor="#313131" bordercolor="#666666" borderopacity="1.0"
                    inkscape:pageopacity="1" inkscape:pageshadow="2" inkscape:zoom="0.22048611" inkscape:cx="2868.3518"
                    inkscape:cy="3583.8082" inkscape:document-units="mm" inkscape:current-layer="layer1-2" showgrid="false"
                    inkscape:pagecheckerboard="false" showborder="false" inkscape:window-width="1920"
                    inkscape:window-height="1017" inkscape:window-x="-8" inkscape:window-y="-8"
                    inkscape:window-maximized="1" fit-margin-top="1" fit-margin-left="1" fit-margin-right="1"
                    fit-margin-bottom="1" />
                <metadata id="metadata5">
                    <rdf:RDF>
                        <cc:Work rdf:about="">
                            <dc:format>image/svg+xml</dc:format>
                            <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                            <dc:title></dc:title>
                        </cc:Work>
                    </rdf:RDF>
                </metadata>
                <g inkscape:label="Ebene 1" inkscape:groupmode="layer" id="layer1" transform="translate(800.62267,738.24006)">
                    <g style="display:inline" id="layer1-2" inkscape:label="Ebene 1" transform="translate(83.154782,18.142863)">
                        <circle inkscape:label="Arabic (Kormakiti)" style="display:inline;opacity:1;fill:#00cc00;fill-opacity:1;stroke-width:0.05019195"
                            r="8.8194447" cy="-384.92026" cx="-362.13428" id="ako" />
                        <circle inkscape:label="Maltese" style="display:inline;opacity:1;fill:#32b400;fill-opacity:1;stroke-width:0.13049906"
                            r="22.930555" cy="-421.47708" cx="-347.59259" id="mlt" />
                        <circle inkscape:label="Crimean Tatar" style="display:inline;fill:#ff7700;fill-opacity:1;stroke-width:0.13049906"
                            r="22.930555" cy="-164.54105" cx="-275.20972" id="cri" />
                        <circle inkscape:label="Gagauz" style="display:inline;fill:#ef770d;fill-opacity:1;stroke-width:0.12046067"
                            r="21.166666" cy="-72.10569" cx="-288.36761" id="gag" />
                        <circle inkscape:label="Karaim" style="display:inline;fill:#ff8000;fill-opacity:1;stroke-width:0.04015356"
                            r="7.0555553" cy="-137.05484" cx="-242.27295" id="krm" />
                        <circle inkscape:label="Krymchak" style="display:inline;fill:#f0800f;fill-opacity:1;stroke-width:0.05019195"
                            r="8.8194447" cy="-120.41135" cx="-275.83081" id="kym" />
                        <circle inkscape:label="Turkish" style="display:inline;fill:#f1680c;fill-opacity:1;stroke-width:0.18069103"
                            r="31.75" cy="-120.77979" cx="-326.25183" id="tur" />
                        <circle inkscape:label="Urum" style="display:inline;fill:#ff6600;fill-opacity:1;stroke-width:0.12046069"
                            r="21.166666" cy="-103.02024" cx="-244.58868" id="urm" />
                        <circle inkscape:label="Basque" style="display:inline;fill:#fa0000;fill-opacity:1;stroke-width:0.14053747"
                            r="24.694445" cy="-496.40051" cx="-269.26688" id="bsq" />
                        <circle inkscape:label="Albanian" style="display:inline;fill:#7e00b3;fill-opacity:1;stroke-width:0.16061425"
                            r="28.222219" cy="-424.28949" cx="73.29744" id="alb" />
                        <circle inkscape:label="Latvian" style="display:inline;fill:#30fcb8;fill-opacity:1;stroke-width:0.14053749"
                            r="24.694445" cy="-484.56619" cx="263.02432" id="lat" />
                        <circle inkscape:label="Lithuanian" style="display:inline;fill:#47edb6;fill-opacity:1;stroke-width:0.15057588"
                            r="26.458334" cy="-509.26944" cx="208.70135" id="lit" />
                        <circle inkscape:label="Breton" style="display:inline;fill:#36eaf3;fill-opacity:1;stroke-width:0.1204607"
                            cy="515.39575" cx="-305.11642" id="bre" r="21.166666" transform="rotate(152.80661)" />
                        <circle inkscape:label="Cornish" style="display:inline;fill:#2ffdfd;fill-opacity:1;stroke-width:0.06023035"
                            cy="553.1731" cx="-299.98575" id="crn" r="10.583333" transform="rotate(152.80661)" />
                        <circle inkscape:label="Irish" style="display:inline;fill:#36efef;fill-opacity:1;stroke-width:0.11042231"
                            cy="503.94714" cx="-253.83975" id="iri" r="19.402779" transform="rotate(152.80661)" />
                        <circle inkscape:label="Manx" style="display:inline;fill:#2ff3fd;fill-opacity:1;stroke-width:0.07026874"
                            cy="538.13629" cx="-268.98941" id="mnx" r="12.347222" transform="rotate(152.80661)" />
                        <circle inkscape:label="Welsh" style="display:inline;fill:#40dfed;fill-opacity:1;stroke-width:0.13049909"
                            cy="579.64392" cx="-265.5997" id="wel" r="22.930555" transform="rotate(152.80661)" />
                        <circle inkscape:label="Gaelic (Scots)" style="display:inline;fill:#2fecfd;fill-opacity:1;stroke-width:0.11042231"
                            cy="542.41125" cx="-229.21411" id="gae" r="19.402779" transform="rotate(152.80661)" />
                        <circle inkscape:label="Alsatian" style="display:inline;fill:#05389e;fill-opacity:1;stroke-width:0.14053749"
                            r="24.694445" cy="-15.023291" cx="31.145086" id="alt" />
                        <circle inkscape:label="Danish" style="display:inline;fill:#094ead;fill-opacity:1;stroke-width:0.16061427"
                            r="28.222219" cy="-154.5555" cx="-9.073081" id="dsh" />
                        <circle inkscape:label="Dutch" style="display:inline;fill:#084ead;fill-opacity:1;stroke-width:0.17065269"
                            r="29.986115" cy="-130.27414" cx="-164.83197" id="dut" />
                        <circle inkscape:label="English" style="display:inline;fill:#003fbc;fill-opacity:1;stroke-width:0.20076784"
                            r="35.277779" cy="-77.46875" cx="-18.04241" id="eng" />
                        <circle inkscape:label="Faroese" style="display:inline;fill:#0024bc;fill-opacity:1;stroke-width:0.11042231"
                            r="19.402779" cy="-211.92941" cx="18.563852" id="far" />
                        <circle inkscape:label="Frisian" style="display:inline;fill:#083da6;fill-opacity:1;stroke-width:0.13049909"
                            r="22.930555" cy="-185.78801" cx="-125.31561" id="fri" />
                        <circle inkscape:label="German" style="display:inline;fill:#0b4ba3;fill-opacity:1;stroke-width:0.18069106"
                            r="31.75" cy="-31.974218" cx="-99.375725" id="ger" />
                        <circle inkscape:label="Icelandic" style="display:inline;fill:#1241b3;fill-opacity:1;stroke-width:0.13049909"
                            r="22.930555" cy="-161.50664" cx="73.473274" id="ice" />
                        <circle inkscape:label="Low German" style="display:inline;fill:#0a40ab;fill-opacity:1;stroke-width:0.16061427"
                            r="28.222219" cy="-127.89153" cx="-72.951836" id="lge" />
                        <circle inkscape:label="Luxemburgeois" style="display:inline;fill:#004fbc;fill-opacity:1;stroke-width:0.13049911"
                            r="22.930555" cy="-60.661205" cx="-164.46747" id="lux" />
                        <circle inkscape:label="Norwegian" style="display:inline;fill:#0c2db4;fill-opacity:1;stroke-width:0.15057589"
                            r="26.458334" cy="-106.28397" cx="113.6795" id="nor" />
                        <circle inkscape:label="Swedish" style="display:inline;fill:#0221a2;fill-opacity:1;stroke-width:0.1606143"
                            r="28.222219" cy="-210.06935" cx="-58.891319" id="swe" />
                        <circle inkscape:label="Yiddish" style="display:inline;fill:#0432a4;fill-opacity:1;stroke-width:0.14053753"
                            r="24.694445" cy="-4.2384319" cx="-38.733025" id="ydd" />
                        <circle inkscape:label="Yiddish (Bessarabian)" style="display:inline;fill:#122fab;fill-opacity:1;stroke-width:0.12046074"
                            r="21.166666" cy="-90.642456" cx="-114.37566" id="ydb" />
                        <circle inkscape:label="Yiddish (Lithuanian)" style="display:inline;fill:#103aa2;fill-opacity:1;stroke-width:0.12046074"
                            r="21.166666" cy="-41.446037" cx="89.376381" id="ylt" />
                        <circle inkscape:label="Yiddish (Lodz)" style="display:inline;fill:#0036bc;fill-opacity:1;stroke-width:0.12046074"
                            r="21.166666" cy="-94.276329" cx="55.170139" id="ydl" />
                        <circle inkscape:label="Greek (Cypriot)" style="display:inline;fill:#30fd85;fill-opacity:1;stroke-width:0.13049914"
                            r="22.930555" cy="-545.09167" cx="-169.66112" id="gcy" />
                        <circle inkscape:label="Greek (Modern)" style="display:inline;fill:#2ef480;fill-opacity:1;stroke-width:0.16061434"
                            r="28.222219" cy="-566.30627" cx="-113.99967" id="grk" />
                        <circle inkscape:label="Romani (Ajia Varvara)" style="display:inline;fill:#0079c0;fill-opacity:1;stroke-width:0.10038397"
                            r="17.638889" cy="-525.54504" cx="86.761925" id="rav" />
                        <circle inkscape:label="Romani (Burgudzi)" style="display:inline;fill:#0871af;fill-opacity:1;stroke-width:0.10038397"
                            r="17.638889" cy="-497.62604" cx="57.301167" id="rbu" />
                        <circle inkscape:label="Romani (Burgenland)" style="display:inline;fill:#0070c0;fill-opacity:1;stroke-width:0.10038397"
                            r="17.638889" cy="-567.42334" cx="92.222649" id="rbg" />
                        <circle inkscape:label="Romani (Kalderash)" style="display:inline;fill:#095d9c;fill-opacity:1;stroke-width:0.10038397"
                            r="17.638889" cy="-481.70721" cx="98.883385" id="rka" />
                        <circle inkscape:label="Romani (Lovari)" style="display:inline;fill:#076eb1;fill-opacity:1;stroke-width:0.10038397"
                            r="17.638889" cy="-475.26666" cx="147.06563" id="rlo" />
                        <circle inkscape:label="Romani (North Russian)" style="display:inline;fill:#1365a3;fill-opacity:1;stroke-width:0.10038397"
                            r="17.638889" cy="-515.18555" cx="128.94414" id="rnr" />
                        <circle inkscape:label="Romani (Sepecides)" style="display:inline;fill:#0074c0;fill-opacity:1;stroke-width:0.10038397"
                            r="17.638889" cy="-553.46387" cx="141.6049" id="rse" />
                        <circle inkscape:label="Romani (Welsh)" style="display:inline;fill:#0f6cb3;fill-opacity:1;stroke-width:0.10038397"
                            r="17.638889" cy="-539.50452" cx="49.440418" id="rwe" />
                        <circle inkscape:label="Asturian" style="display:inline;fill:#07207c;fill-opacity:1;stroke-width:0.13049915"
                            r="22.930555" cy="-386.9176" cx="-174.90674" id="ast" />
                        <circle inkscape:label="French" style="display:inline;fill:#1d066f;fill-opacity:1;stroke-width:0.18069114"
                            r="31.75" cy="-313.15778" cx="-150.6275" id="fre" />
                        <circle inkscape:label="Galician" style="display:inline;fill:#062f80;fill-opacity:1;stroke-width:0.15057595"
                            r="26.458334" cy="-501.21637" cx="-39.662624" id="glc" />
                        <circle inkscape:label="Catalan" style="display:inline;fill:#1f008c;fill-opacity:1;stroke-width:0.15057595"
                            r="26.458334" cy="-336.22531" cx="-209.62842" id="ctl" />
                        <circle inkscape:label="Italian" style="display:inline;fill:#042669;fill-opacity:1;stroke-width:0.18069114"
                            r="31.75" cy="-463.22311" cx="-182.80368" id="ita" />
                        <circle inkscape:label="Ladin" style="display:inline;fill:#001d8c;fill-opacity:1;stroke-width:0.11042237"
                            r="19.402779" cy="-427.27039" cx="-127.129" id="ldn" />
                        <circle inkscape:label="Ladino" style="display:inline;fill:#002f8c;fill-opacity:1;stroke-width:0.12046076"
                            r="21.166666" cy="-442.16724" cx="-71.194031" id="lno" />
                        <circle inkscape:label="Moldavian" style="display:inline;fill:#33056d;fill-opacity:1;stroke-width:0.15057595"
                            r="26.458334" cy="-485.12759" cx="-110.62253" id="mol" />
                        <circle inkscape:label="Occitan" style="display:inline;fill:#3c0583;fill-opacity:1;stroke-width:0.14053756"
                            r="24.694445" cy="-327.04874" cx="-39.018032" id="occ" />
                        <circle inkscape:label="Portuguese" style="display:inline;fill:#20067d;fill-opacity:1;stroke-width:0.19072954"
                            r="33.513889" cy="-366.23834" cx="-102.00125" id="por" />
                        <circle inkscape:label="Provencal" style="display:inline;fill:#2e008c;fill-opacity:1;stroke-width:0.13049915"
                            r="22.930555" cy="-294.01819" cx="-86.207397" id="pro" />
                        <circle inkscape:label="Romanian" style="display:inline;fill:#1b0763;fill-opacity:1;stroke-width:0.17065275"
                            r="29.986115" cy="-447.00589" cx="-5.1448646" id="rom" />
                        <circle inkscape:label="Romansch" style="display:inline;fill:#430099;fill-opacity:1;stroke-width:0.11042236"
                            r="19.402779" cy="-391.31757" cx="-44.36935" id="rmc" />
                        <circle inkscape:label="Sardinian" style="display:inline;fill:#2c067b;fill-opacity:1;stroke-width:0.14053755"
                            r="24.694445" cy="-377.48856" cx="7.9111657" id="srd" />
                        <circle inkscape:label="Spanish" style="display:inline;fill:#081d6a;fill-opacity:1;stroke-width:0.20076792"
                            r="35.277779" cy="-243.83099" cx="-183.58414" id="spa" />
                        <circle inkscape:label="Belorussian" style="display:inline;fill:#18a4ec;fill-opacity:1;stroke-width:0.15057594"
                            r="26.458334" cy="-318.6907" cx="151.45705" id="blr" />
                        <circle inkscape:label="Bosnian" style="display:inline;fill:#54a7f5;fill-opacity:1;stroke-width:0.15057594"
                            r="26.458334" cy="-299.07687" cx="234.92101" id="bos" />
                        <circle inkscape:label="Bulgarian" style="display:inline;fill:#2eb7fe;fill-opacity:1;stroke-width:0.16061434"
                            r="28.222219" cy="-238.54344" cx="250.05103" id="bul" />
                        <circle inkscape:label="Czech" style="display:inline;fill:#38afed;fill-opacity:1;stroke-width:0.16061436"
                            r="28.222219" cy="-351.64899" cx="86.159012" id="cze" />
                        <circle inkscape:label="Kashubian" style="display:inline;fill:#309be9;fill-opacity:1;stroke-width:0.12046078"
                            r="21.166666" cy="-274.49265" cx="112.24567" id="ksu" />
                        <circle inkscape:label="Macedonian" style="display:inline;fill:#69c1f6;fill-opacity:1;stroke-width:0.150576"
                            r="26.458334" cy="-354.23511" cx="203.98903" id="mcd" />
                        <circle inkscape:label="Polish" style="display:inline;fill:#3aa2ed;fill-opacity:1;stroke-width:0.1806912"
                            r="31.75" cy="-359.01559" cx="272.43259" id="pol" />
                        <circle inkscape:label="Russian" style="display:inline;fill:#2e99fe;fill-opacity:1;stroke-width:0.1907296"
                            r="33.513889" cy="-256.02115" cx="180.05301" id="rus" />
                        <circle inkscape:label="Serbo-Croatian" style="display:inline;fill:#1a9ee2;fill-opacity:1;stroke-width:0.17065281"
                            r="29.986115" cy="-391.80731" cx="144.09099" id="scr" />
                        <circle inkscape:label="Slovak" style="display:inline;fill:#2ea6fe;fill-opacity:1;stroke-width:0.150576"
                            r="26.458334" cy="-410.59338" cx="223.95502" id="svk" />
                        <circle inkscape:label="Slovene" style="display:inline;fill:#39acf2;fill-opacity:1;stroke-width:0.150576"
                            cy="-190.69122" cx="173.61755" id="slo" r="26.458334" />
                        <circle inkscape:label="Sorbian" style="display:inline;fill:#2eaffe;fill-opacity:1;stroke-width:0.1104224"
                            r="19.402779" cy="-217.48198" cx="124.74681" id="srb" />
                        <circle inkscape:label="Ukrainian" style="display:inline;fill:#228df2;fill-opacity:1;stroke-width:0.1806912"
                            r="31.75" cy="-283.39584" cx="49.344151" id="ukr" />
                        <circle inkscape:label="Adyghe (Shapsugh)" style="display:inline;fill:#e4bd00;fill-opacity:1;stroke-width:0.1304992"
                            r="22.930555" cy="-403.06888" cx="-270.24396" id="ash" />
                        <circle inkscape:label="Estonian" style="display:inline;fill:#cc004c;fill-opacity:1;stroke-width:0.14053762"
                            r="24.694445" cy="-326.25668" cx="-320.43124" id="est" />
                        <circle inkscape:label="Finnish" style="display:inline;fill:#bc0c4e;fill-opacity:1;stroke-width:0.16061442"
                            r="28.222219" cy="-269.33603" cx="-304.8345" id="fin" />
                        <circle inkscape:label="Karelian" style="display:inline;fill:#bc0b63;fill-opacity:1;stroke-width:0.10038402"
                            r="17.638889" cy="-327.7923" cx="-271.37122" id="krl" />
                        <circle inkscape:label="Liv" style="display:inline;fill:#cc0080;fill-opacity:1;stroke-width:0.04015361"
                            r="7.0555553" cy="-304.44241" cx="-292.25308" id="liv" />
                        <circle inkscape:label="Veps" style="display:inline;fill:#cc0066;fill-opacity:1;stroke-width:0.07026882"
                            r="12.347222" cy="-291.85318" cx="-266.29471" id="vep" />
                        <circle inkscape:label="Votic" style="display:inline;fill:#c00b7c;fill-opacity:1;stroke-width:0.04015361"
                            r="7.0555553" cy="-293.01062" cx="-332.68845" id="vot" />
                        <circle inkscape:label="Saami (Central-South)" style="display:inline;fill:#99004c;fill-opacity:1;stroke-width:0.06023042"
                            r="10.583333" cy="-229.88101" cx="-392.43158" id="scs" />
                        <circle inkscape:label="Saami (Kildin)" style="display:inline;fill:#8b0849;fill-opacity:1;stroke-width:0.07026882"
                            r="12.347222" cy="-251.67247" cx="-368.86578" id="ski" />
                        <circle inkscape:label="Saami (Northern)" style="display:inline;fill:#7e0843;fill-opacity:1;stroke-width:0.10038403"
                            r="17.638889" cy="-217.93236" cx="-358.37506" id="sno" />
                        <circle inkscape:label="Hungarian" style="display:inline;fill:#ff33cc;fill-opacity:1;stroke-width:0.16061445"
                            r="28.222219" cy="-312.31967" cx="-395.9285" id="hun" />
                    </g>
                </g>
            </svg>
        </div>
    </div>

    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.3.0/snap.svg-min.js"></script>

    <script>
        width = parseInt(d3.select('#map-container').style('width')),
            height = 800;

        //console.log(width)
        var svg = d3.select("#map-container")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        //var files = ["/geojsons/states.geojson", "/geojsons/us-counties-topo.json"];
        var files = ["geojsons/europeWrussia.geojson", "geojsons/languages.geojson"];
        var promises = [];


        files.forEach(function (url) {
            promises.push(d3.json(url))
        });


        Promise.all(promises).then(function (values) {
            makeMap(values[0], values[1])

        });


        var projection = d3.geoMercator();
        var geoPath = d3.geoPath()
            .projection(projection);

        var radius = d3.scaleLog();

        function makeMap(europe, languages) {

            console.log(europe);

            projection.fitSize([width - 300, height], europe);

            svg.append("g")
                .selectAll("path")
                .data(europe.features)
                .enter()
                .append("path")
                .attr("d", geoPath)
                .attr("stroke", "rgba(8, 81, 156, 0.2)")
                .attr("fill", "lightgrey")
                .attr("class", "europe");

            addBubbles(languages)
        }

        function addBubbles(languages) {

            var bubbles = svg.selectAll("circle")
                .data(languages.features)
                .enter().append("circle")
                .attr('r', function (d) {
                    return radius(d.properties.speakers) * 2
                })
                .attr('cx', function (d) {
                    return projection(d.geometry.coordinates)[0]
                })
                .attr('cy', function (d) {
                    return projection(d.geometry.coordinates)[1]
                })
                .attr("class", "languages")
                .call(d3.drag()
                    .on("start", dragStart)
                    .on("drag", dragged)
                    .on("end", dragEnd));

            bubbles.append("svg:title")
                .text(function (d) {
                    return d.properties.Name;
                });

            function dragStart(d) {
                d3.select(this).classed("active", true)

            }

            function dragged(d) {
                d3.select(this)
                    .attr("cx", d3.event.x)
                    .attr("cy", d3.event.y);

            }

            function dragEnd(d) {
                d3.select(this)
                    .classed("active", false)
                    .transition()
                    .duration(1500)
                    .attr('cx', function (d) {
                        return projection(d.geometry.coordinates)[0]
                    })
                    .attr('cy', function (d) {
                        return projection(d.geometry.coordinates)[1]
                    })
                console.log(d)
            }

        }
    </script>
</body>

</html>